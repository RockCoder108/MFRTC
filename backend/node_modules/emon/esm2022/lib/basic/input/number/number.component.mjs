import { Component, forwardRef, Input, ViewChild } from "@angular/core";
import { NG_VALUE_ACCESSOR } from "@angular/forms";
import { InputBaseComponent } from "../../../core/input-base/input-base";
import { getIconValidationStatus } from "../../../service/utilities/template.utility";
import { INPUT_NUMBER_ICONS } from "../../../model/const/constant";
import { checkKeyPressedUtility } from "./utility/number.utility";
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "../text/text.component";
export class NumberComponent extends InputBaseComponent {
    elementRef;
    step = 1; // The value of each step. can be decimal.
    inputTextComponent;
    pattern = '^\\d*(\\.\\d{0,decimalLenght})?$';
    set value(val) {
        if (Number(val) || (typeof val === 'string' && val === '')) {
            super.value = val;
        }
        else {
            if (val) {
                console.error(`Error: ${val} is not a number`);
            }
        }
    }
    get value() {
        return super.value;
    }
    icons = INPUT_NUMBER_ICONS;
    constructor(elementRef) {
        super();
        this.elementRef = elementRef;
    }
    ngOnInit() {
        if (this.elementRef.nativeElement.width !== '200px') {
            this.width = this.elementRef.nativeElement.width;
        }
        this.checkDecimalLenght();
    }
    /**
     * Check keyboard when press and not take value if not inherent of number
     * @public
     * @returns
     * @member NumberComponent
     */
    checkKeyPressed(eventKB) {
        checkKeyPressedUtility(eventKB, String(this.value));
    }
    /**
     * Set value when click buttons add/sub
     * @public
     * @returns
     * @member NumberComponent
     */
    onIconClick(icon) {
        if (this.value === undefined || this.value === null) {
            this.value = 0;
        }
        if (icon.name === 'add') {
            this.value = Number(this.value) + (!this.step ? 1 : this.step);
        }
        else {
            this.value = Number(this.value) - (!this.step ? 1 : this.step);
        }
        this.value = this.getRightDecimal();
    }
    /**
     * Set the pattern to apply on input with number of decimal
     * @public
     * @returns
     * @member NumberComponent
     */
    checkDecimalLenght() {
        const lenghtDecimalSeparator = this.getLenghtDecimalSeparator();
        if (lenghtDecimalSeparator >= 0) {
            this.pattern = this.pattern.replace('decimalLenght', lenghtDecimalSeparator.toString());
        }
    }
    /**
     * Handle icons validation when validationStatus variable is decleared
     * @public
     * @returns string: icon name. can be check_circle | warning | error
     * @member NumberComponent
     */
    getIconValidationStatus() {
        return getIconValidationStatus(this.validationStatus);
    }
    /**
     * Calculate length of decimal based on step. If last numbers are zero they are not recognized
     * @private
     * @returns number = length of decimal
     * @member NumberComponent
     */
    getLenghtDecimalSeparator() {
        const indexSeparator = this.step.toString().indexOf(',') >= 0 ?
            this.step.toString().indexOf(',') : this.step.toString().indexOf('.');
        const decimal = this.step?.toString().substring(indexSeparator + 1, this.step?.toString().length);
        return decimal.length;
    }
    /**
     * set right value with right number of decimal
     * @private
     * @returns number = right value with right length of decimal
     * @member NumberComponent
     */
    getRightDecimal() {
        return Number(Number.parseFloat(String(this.value)).toFixed(this.getLenghtDecimalSeparator()));
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.9", ngImport: i0, type: NumberComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.2.9", type: NumberComponent, selector: "e-mon-number", inputs: { step: "step" }, providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => NumberComponent),
                multi: true
            }
        ], viewQueries: [{ propertyName: "inputTextComponent", first: true, predicate: ["inputText"], descendants: true, static: true }], usesInheritance: true, ngImport: i0, template: "<e-mon-text\r\n    #inputText\r\n    class=\"in-num\"\r\n    [(ngModel)]=\"value\"\r\n    [icons]=\"icons\"\r\n    [pattern]=\"pattern\"\r\n    [styleClass]=\"styleClass\"\r\n    [label]=\"label\"\r\n    [isDisabled]=\"isDisabled\"\r\n    [validationStatus]=\"validationStatus\"\r\n    [width]=\"width\"\r\n    (onIconClick)=\"onIconClick($event)\"\r\n    (keydown)=\"checkKeyPressed($event)\"\r\n></e-mon-text>\r\n\r\n\r\n", styles: ["body.default-theme{--primary: #0b3954;--primary-half-transparency: rgba(11, 57, 84, .7);--secondary: #ff5a5f;--tertiary: #3E92CC;--tertiary-half-transparency: rgba(62, 146, 204, .5);--fourth: #DADDD8;--pure-white: #FFFFFF;--grey-border: #CCCCCC;--grey-background: #F2F2F2;--grey-font-color: #A0AAB2;--placeholder: #808080;--error: #c81d25;--error-half-transparency: rgba(200, 29, 37, .5);--warning: #F18701;--warning-half-transparency: rgba(241, 135, 1, .5);--success: #008148;--success-half-transparency: rgba(0, 129, 72, .5);--fontColor: #0D1321;--font-size-medium: 14px;--font-size-large: .86rem;--font-weight-5: 500;--font-weight-6: 600;--font-weight-7: 700;--radius-4: 4px;--radius-8: 8px;--border_thickness_1: 1px;--border_thickness_2: 2px}body.default-theme button[disabled],body.default-theme button:disabled{background-color:var(--grey-background)!important;border:1px solid var(--grey-border)!important;color:var(--grey-font-color)!important;pointer-events:none}body.default-theme .disabled{pointer-events:none}body.default-theme .disabled .in-txt{background-color:var(--grey-background);cursor:default;color:var(--grey-font-color);border:var(--border_thickness_1) solid var(--grey-border)}body.default-theme .disabled .in-txt input{background-color:var(--grey-background);cursor:default;outline:none;color:var(--grey-font-color)!important}body.default-theme .disabled .label{color:var(--grey-font-color)!important}body.default-theme .disabled .shell .in-chkbx{border:var(--border_thickness_2) solid var(--grey-border)!important}body.default-theme .disabled .shell .checked{background-color:var(--grey-border)!important}html{font-size:16px}*,*:before,*:after{box-sizing:border-box;letter-spacing:normal}:root{--width_8: 8px;--width_10: 10px;--width_12: 12px;--width_14: 14px;--width_16: 16px;--width_18: 18px;--width_20: 20px;--width_22: 22px;--width_24: 24px;--width_26: 26px;--width_28: 28px;--width_30: 30px;--width_32: 32px;--width_34: 34px;--width_36: 36px;--width_38: 38px;--width_40: 40px;--height_8: 8px;--height_10: 10px;--height_12: 12px;--height_14: 14px;--height_16: 16px;--height_18: 18px;--height_20: 20px;--height_22: 22px;--height_24: 24px;--height_26: 26px;--height_28: 28px;--height_30: 30px;--height_32: 32px;--height_34: 34px;--height_36: 36px;--height_38: 38px;--height_40: 40px;--margin_4: 4px;--margin_8: 8px;--padding_4: 4px;--padding_8: 8px;--transparent: transparent}@font-face{font-family:Material Icons;font-style:normal;font-weight:400;src:local(\"Material Icons\"),local(\"MaterialIcons-Regular\"),url(https://fonts.gstatic.com/s/materialicons/v140/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format(\"woff2\")}:root .material-icons{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;display:inline-block;position:inherit;line-height:1;text-transform:none;letter-spacing:normal;word-wrap:normal;white-space:nowrap;direction:ltr;vertical-align:middle;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:\"liga\"}:root .noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host{display:inline-block;position:relative;height:36px;min-width:100px!important;vertical-align:bottom;box-sizing:border-box}:host .in-num{width:inherit}:host .number-container{display:inline-flex}:host e-mon-text ::ng-deep input{text-align:center}:host e-mon-text ::ng-deep e-mon-icon:not(.icon_success):not(.icon_error):not(.icon_warning):hover{box-shadow:1px 1px 1px 1px var(--grey-border);border-radius:50%}:host e-mon-text ::ng-deep e-mon-icon:not(.icon_success):not(.icon_error):not(.icon_warning):active{box-shadow:-1px -1px 3px 0 var(--grey-background) inset;background-color:var(--grey-border);background-size:100%;transition:background .3s}\n"], dependencies: [{ kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.PatternValidator, selector: "[pattern][formControlName],[pattern][formControl],[pattern][ngModel]", inputs: ["pattern"] }, { kind: "directive", type: i1.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "component", type: i2.TextComponent, selector: "e-mon-text", inputs: ["placeholder", "type", "icons"], outputs: ["onIconClick"] }] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.9", ngImport: i0, type: NumberComponent, decorators: [{
            type: Component,
            args: [{ selector: 'e-mon-number', providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => NumberComponent),
                            multi: true
                        }
                    ], template: "<e-mon-text\r\n    #inputText\r\n    class=\"in-num\"\r\n    [(ngModel)]=\"value\"\r\n    [icons]=\"icons\"\r\n    [pattern]=\"pattern\"\r\n    [styleClass]=\"styleClass\"\r\n    [label]=\"label\"\r\n    [isDisabled]=\"isDisabled\"\r\n    [validationStatus]=\"validationStatus\"\r\n    [width]=\"width\"\r\n    (onIconClick)=\"onIconClick($event)\"\r\n    (keydown)=\"checkKeyPressed($event)\"\r\n></e-mon-text>\r\n\r\n\r\n", styles: ["body.default-theme{--primary: #0b3954;--primary-half-transparency: rgba(11, 57, 84, .7);--secondary: #ff5a5f;--tertiary: #3E92CC;--tertiary-half-transparency: rgba(62, 146, 204, .5);--fourth: #DADDD8;--pure-white: #FFFFFF;--grey-border: #CCCCCC;--grey-background: #F2F2F2;--grey-font-color: #A0AAB2;--placeholder: #808080;--error: #c81d25;--error-half-transparency: rgba(200, 29, 37, .5);--warning: #F18701;--warning-half-transparency: rgba(241, 135, 1, .5);--success: #008148;--success-half-transparency: rgba(0, 129, 72, .5);--fontColor: #0D1321;--font-size-medium: 14px;--font-size-large: .86rem;--font-weight-5: 500;--font-weight-6: 600;--font-weight-7: 700;--radius-4: 4px;--radius-8: 8px;--border_thickness_1: 1px;--border_thickness_2: 2px}body.default-theme button[disabled],body.default-theme button:disabled{background-color:var(--grey-background)!important;border:1px solid var(--grey-border)!important;color:var(--grey-font-color)!important;pointer-events:none}body.default-theme .disabled{pointer-events:none}body.default-theme .disabled .in-txt{background-color:var(--grey-background);cursor:default;color:var(--grey-font-color);border:var(--border_thickness_1) solid var(--grey-border)}body.default-theme .disabled .in-txt input{background-color:var(--grey-background);cursor:default;outline:none;color:var(--grey-font-color)!important}body.default-theme .disabled .label{color:var(--grey-font-color)!important}body.default-theme .disabled .shell .in-chkbx{border:var(--border_thickness_2) solid var(--grey-border)!important}body.default-theme .disabled .shell .checked{background-color:var(--grey-border)!important}html{font-size:16px}*,*:before,*:after{box-sizing:border-box;letter-spacing:normal}:root{--width_8: 8px;--width_10: 10px;--width_12: 12px;--width_14: 14px;--width_16: 16px;--width_18: 18px;--width_20: 20px;--width_22: 22px;--width_24: 24px;--width_26: 26px;--width_28: 28px;--width_30: 30px;--width_32: 32px;--width_34: 34px;--width_36: 36px;--width_38: 38px;--width_40: 40px;--height_8: 8px;--height_10: 10px;--height_12: 12px;--height_14: 14px;--height_16: 16px;--height_18: 18px;--height_20: 20px;--height_22: 22px;--height_24: 24px;--height_26: 26px;--height_28: 28px;--height_30: 30px;--height_32: 32px;--height_34: 34px;--height_36: 36px;--height_38: 38px;--height_40: 40px;--margin_4: 4px;--margin_8: 8px;--padding_4: 4px;--padding_8: 8px;--transparent: transparent}@font-face{font-family:Material Icons;font-style:normal;font-weight:400;src:local(\"Material Icons\"),local(\"MaterialIcons-Regular\"),url(https://fonts.gstatic.com/s/materialicons/v140/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format(\"woff2\")}:root .material-icons{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;display:inline-block;position:inherit;line-height:1;text-transform:none;letter-spacing:normal;word-wrap:normal;white-space:nowrap;direction:ltr;vertical-align:middle;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:\"liga\"}:root .noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host{display:inline-block;position:relative;height:36px;min-width:100px!important;vertical-align:bottom;box-sizing:border-box}:host .in-num{width:inherit}:host .number-container{display:inline-flex}:host e-mon-text ::ng-deep input{text-align:center}:host e-mon-text ::ng-deep e-mon-icon:not(.icon_success):not(.icon_error):not(.icon_warning):hover{box-shadow:1px 1px 1px 1px var(--grey-border);border-radius:50%}:host e-mon-text ::ng-deep e-mon-icon:not(.icon_success):not(.icon_error):not(.icon_warning):active{box-shadow:-1px -1px 3px 0 var(--grey-background) inset;background-color:var(--grey-border);background-size:100%;transition:background .3s}\n"] }]
        }], ctorParameters: () => [{ type: i0.ElementRef }], propDecorators: { step: [{
                type: Input
            }], inputTextComponent: [{
                type: ViewChild,
                args: ['inputText', { static: true }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVtYmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xpYnJhcnkvc3JjL2xpYi9iYXNpYy9pbnB1dC9udW1iZXIvbnVtYmVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xpYnJhcnkvc3JjL2xpYi9iYXNpYy9pbnB1dC9udW1iZXIvbnVtYmVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQWMsVUFBVSxFQUFFLEtBQUssRUFBb0MsU0FBUyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3BILE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ2pELE9BQU8sRUFBQyxrQkFBa0IsRUFBQyxNQUFNLHFDQUFxQyxDQUFDO0FBR3ZFLE9BQU8sRUFBQyx1QkFBdUIsRUFBQyxNQUFNLDZDQUE2QyxDQUFDO0FBQ3BGLE9BQU8sRUFBQyxrQkFBa0IsRUFBQyxNQUFNLCtCQUErQixDQUFDO0FBQ2pFLE9BQU8sRUFBQyxzQkFBc0IsRUFBQyxNQUFNLDBCQUEwQixDQUFDOzs7O0FBY2hFLE1BQU0sT0FBTyxlQUFnQixTQUFRLGtCQUEwQjtJQXFCdkM7SUFwQlgsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLDBDQUEwQztJQUVyQixrQkFBa0IsQ0FBaUI7SUFFbEUsT0FBTyxHQUFHLGtDQUFrQyxDQUFDO0lBQ3RELElBQWEsS0FBSyxDQUFDLEdBQThCO1FBQzdDLElBQUksTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssUUFBUSxJQUFJLEdBQUcsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQ3pELEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDO1FBQ3RCLENBQUM7YUFBTSxDQUFDO1lBQ0osSUFBSSxHQUFHLEVBQUUsQ0FBQztn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QUFJLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2xHLE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQztJQUMxQixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSyxlQUFlO1FBQ25CLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDbkcsQ0FBQzt1R0ExR1EsZUFBZTsyRkFBZixlQUFlLGlFQVJiO1lBQ1A7Z0JBQ0ksT0FBTyxFQUFFLGlCQUFpQjtnQkFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQUM7Z0JBQzlDLEtBQUssRUFBRSxJQUFJO2FBQ2Q7U0FDSixnTENuQkwseWFBZ0JBOzsyRkRLYSxlQUFlO2tCQVozQixTQUFTOytCQUNJLGNBQWMsYUFHYjt3QkFDUDs0QkFDSSxPQUFPLEVBQUUsaUJBQWlCOzRCQUMxQixXQUFXLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBRSxnQkFBZ0IsQ0FBQzs0QkFDOUMsS0FBSyxFQUFFLElBQUk7eUJBQ2Q7cUJBQ0o7K0VBR1EsSUFBSTtzQkFBWixLQUFLO2dCQUVrQyxrQkFBa0I7c0JBQXpELFNBQVM7dUJBQUMsV0FBVyxFQUFFLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBFbGVtZW50UmVmLCBmb3J3YXJkUmVmLCBJbnB1dCwgT25DaGFuZ2VzLCBPbkluaXQsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHtOR19WQUxVRV9BQ0NFU1NPUn0gZnJvbSBcIkBhbmd1bGFyL2Zvcm1zXCI7XHJcbmltcG9ydCB7SW5wdXRCYXNlQ29tcG9uZW50fSBmcm9tIFwiLi4vLi4vLi4vY29yZS9pbnB1dC1iYXNlL2lucHV0LWJhc2VcIjtcclxuaW1wb3J0IHtJY29uLCBJY29uc30gZnJvbSBcIi4uLy4uLy4uL21vZGVsL2ludGVyZmFjZS9pY29uLmludGVyZmFjZVwiO1xyXG5pbXBvcnQge1RleHRDb21wb25lbnR9IGZyb20gXCIuLi90ZXh0L3RleHQuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7Z2V0SWNvblZhbGlkYXRpb25TdGF0dXN9IGZyb20gXCIuLi8uLi8uLi9zZXJ2aWNlL3V0aWxpdGllcy90ZW1wbGF0ZS51dGlsaXR5XCI7XHJcbmltcG9ydCB7SU5QVVRfTlVNQkVSX0lDT05TfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWwvY29uc3QvY29uc3RhbnRcIjtcclxuaW1wb3J0IHtjaGVja0tleVByZXNzZWRVdGlsaXR5fSBmcm9tIFwiLi91dGlsaXR5L251bWJlci51dGlsaXR5XCI7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZS1tb24tbnVtYmVyJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9udW1iZXIuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vbnVtYmVyLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBOdW1iZXJDb21wb25lbnQpLFxyXG4gICAgICAgICAgICBtdWx0aTogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIE51bWJlckNvbXBvbmVudCBleHRlbmRzIElucHV0QmFzZUNvbXBvbmVudDxudW1iZXI+IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIEBJbnB1dCgpIHN0ZXAgPSAxOyAvLyBUaGUgdmFsdWUgb2YgZWFjaCBzdGVwLiBjYW4gYmUgZGVjaW1hbC5cclxuXHJcbiAgICBAVmlld0NoaWxkKCdpbnB1dFRleHQnLCB7c3RhdGljOiB0cnVlfSkgaW5wdXRUZXh0Q29tcG9uZW50ITogVGV4dENvbXBvbmVudDtcclxuXHJcbiAgICBvdmVycmlkZSBwYXR0ZXJuID0gJ15cXFxcZCooXFxcXC5cXFxcZHswLGRlY2ltYWxMZW5naHR9KT8kJztcclxuICAgIG92ZXJyaWRlIHNldCB2YWx1ZSh2YWw6IG51bWJlciB8IHVuZGVmaW5lZCB8IG51bGwpIHtcclxuICAgICAgICBpZiAoTnVtYmVyKHZhbCkgfHwgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnICYmIHZhbCA9PT0gJycpKSB7XHJcbiAgICAgICAgICAgIHN1cGVyLnZhbHVlID0gdmFsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yOiAke3ZhbH0gaXMgbm90IGEgbnVtYmVyYClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG92ZXJyaWRlIGdldCB2YWx1ZSgpOiBudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsIHtcclxuICAgICAgICByZXR1cm4gc3VwZXIudmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmVhZG9ubHkgaWNvbnMgPSBJTlBVVF9OVU1CRVJfSUNPTlM7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQud2lkdGggIT09ICcyMDBweCcpIHtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LndpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrRGVjaW1hbExlbmdodCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sga2V5Ym9hcmQgd2hlbiBwcmVzcyBhbmQgbm90IHRha2UgdmFsdWUgaWYgbm90IGluaGVyZW50IG9mIG51bWJlclxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICogQHJldHVybnNcclxuICAgICAqIEBtZW1iZXIgTnVtYmVyQ29tcG9uZW50XHJcbiAgICAgKi9cclxuICAgIGNoZWNrS2V5UHJlc3NlZChldmVudEtCOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgY2hlY2tLZXlQcmVzc2VkVXRpbGl0eShldmVudEtCLCBTdHJpbmcodGhpcy52YWx1ZSkpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCB2YWx1ZSB3aGVuIGNsaWNrIGJ1dHRvbnMgYWRkL3N1YlxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICogQHJldHVybnNcclxuICAgICAqIEBtZW1iZXIgTnVtYmVyQ29tcG9uZW50XHJcbiAgICAgKi9cclxuICAgIG9uSWNvbkNsaWNrKGljb246IEljb24pOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHRoaXMudmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaWNvbi5uYW1lID09PSAnYWRkJykge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gTnVtYmVyKHRoaXMudmFsdWUpICsgKCF0aGlzLnN0ZXAgPyAxIDogdGhpcy5zdGVwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gTnVtYmVyKHRoaXMudmFsdWUpIC0gKCF0aGlzLnN0ZXAgPyAxIDogdGhpcy5zdGVwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuZ2V0UmlnaHREZWNpbWFsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIHBhdHRlcm4gdG8gYXBwbHkgb24gaW5wdXQgd2l0aCBudW1iZXIgb2YgZGVjaW1hbFxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICogQHJldHVybnNcclxuICAgICAqIEBtZW1iZXIgTnVtYmVyQ29tcG9uZW50XHJcbiAgICAgKi9cclxuICAgIGNoZWNrRGVjaW1hbExlbmdodCgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBsZW5naHREZWNpbWFsU2VwYXJhdG9yID0gdGhpcy5nZXRMZW5naHREZWNpbWFsU2VwYXJhdG9yKCk7XHJcbiAgICAgICAgaWYgKGxlbmdodERlY2ltYWxTZXBhcmF0b3IgPj0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhdHRlcm4gPSB0aGlzLnBhdHRlcm4ucmVwbGFjZSgnZGVjaW1hbExlbmdodCcsIGxlbmdodERlY2ltYWxTZXBhcmF0b3IudG9TdHJpbmcoKSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGUgaWNvbnMgdmFsaWRhdGlvbiB3aGVuIHZhbGlkYXRpb25TdGF0dXMgdmFyaWFibGUgaXMgZGVjbGVhcmVkXHJcbiAgICAgKiBAcHVibGljXHJcbiAgICAgKiBAcmV0dXJucyBzdHJpbmc6IGljb24gbmFtZS4gY2FuIGJlIGNoZWNrX2NpcmNsZSB8IHdhcm5pbmcgfCBlcnJvclxyXG4gICAgICogQG1lbWJlciBOdW1iZXJDb21wb25lbnRcclxuICAgICAqL1xyXG4gICAgZ2V0SWNvblZhbGlkYXRpb25TdGF0dXMoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gZ2V0SWNvblZhbGlkYXRpb25TdGF0dXModGhpcy52YWxpZGF0aW9uU3RhdHVzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGN1bGF0ZSBsZW5ndGggb2YgZGVjaW1hbCBiYXNlZCBvbiBzdGVwLiBJZiBsYXN0IG51bWJlcnMgYXJlIHplcm8gdGhleSBhcmUgbm90IHJlY29nbml6ZWRcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcmV0dXJucyBudW1iZXIgPSBsZW5ndGggb2YgZGVjaW1hbFxyXG4gICAgICogQG1lbWJlciBOdW1iZXJDb21wb25lbnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRMZW5naHREZWNpbWFsU2VwYXJhdG9yKCk6IG51bWJlciB7XHJcbiAgICAgICAgY29uc3QgaW5kZXhTZXBhcmF0b3IgPSB0aGlzLnN0ZXAudG9TdHJpbmcoKS5pbmRleE9mKCcsJykgPj0gMCA/XHJcbiAgICAgICAgICAgIHRoaXMuc3RlcC50b1N0cmluZygpLmluZGV4T2YoJywnKSA6IHRoaXMuc3RlcC50b1N0cmluZygpLmluZGV4T2YoJy4nKTtcclxuICAgICAgICBjb25zdCBkZWNpbWFsID0gdGhpcy5zdGVwPy50b1N0cmluZygpLnN1YnN0cmluZyhpbmRleFNlcGFyYXRvciArIDEsIHRoaXMuc3RlcD8udG9TdHJpbmcoKS5sZW5ndGgpO1xyXG4gICAgICAgIHJldHVybiBkZWNpbWFsLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIHNldCByaWdodCB2YWx1ZSB3aXRoIHJpZ2h0IG51bWJlciBvZiBkZWNpbWFsXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHJldHVybnMgbnVtYmVyID0gcmlnaHQgdmFsdWUgd2l0aCByaWdodCBsZW5ndGggb2YgZGVjaW1hbFxyXG4gICAgICogQG1lbWJlciBOdW1iZXJDb21wb25lbnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRSaWdodERlY2ltYWwoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gTnVtYmVyKE51bWJlci5wYXJzZUZsb2F0KFN0cmluZyh0aGlzLnZhbHVlKSkudG9GaXhlZCh0aGlzLmdldExlbmdodERlY2ltYWxTZXBhcmF0b3IoKSkpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iLCI8ZS1tb24tdGV4dFxyXG4gICAgI2lucHV0VGV4dFxyXG4gICAgY2xhc3M9XCJpbi1udW1cIlxyXG4gICAgWyhuZ01vZGVsKV09XCJ2YWx1ZVwiXHJcbiAgICBbaWNvbnNdPVwiaWNvbnNcIlxyXG4gICAgW3BhdHRlcm5dPVwicGF0dGVyblwiXHJcbiAgICBbc3R5bGVDbGFzc109XCJzdHlsZUNsYXNzXCJcclxuICAgIFtsYWJlbF09XCJsYWJlbFwiXHJcbiAgICBbaXNEaXNhYmxlZF09XCJpc0Rpc2FibGVkXCJcclxuICAgIFt2YWxpZGF0aW9uU3RhdHVzXT1cInZhbGlkYXRpb25TdGF0dXNcIlxyXG4gICAgW3dpZHRoXT1cIndpZHRoXCJcclxuICAgIChvbkljb25DbGljayk9XCJvbkljb25DbGljaygkZXZlbnQpXCJcclxuICAgIChrZXlkb3duKT1cImNoZWNrS2V5UHJlc3NlZCgkZXZlbnQpXCJcclxuPjwvZS1tb24tdGV4dD5cclxuXHJcblxyXG4iXX0=